#!/usr/bin/env bash

if [[ -z $(which opm-version 2> /dev/null) ]]; then
PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" || exit; pwd):$PATH"
fi

export OPY_SUFFIX=labelme
export OPY_VERSION=${OPY_VERSION:-$(opm-variable OPY3_VERSION)}
export OPY_VERBOSE=${OPY_VERBOSE:-$(opm-variable OPY_VERBOSE)}

function install_labelme_if_not_exist
{
    opy3-pip show labelme &> /dev/null
    local code=$?
    if [[ $code -eq 0 ]]; then
        return 0
    fi

    opy3-pip install -U labelme
}

function exit_on_error
{
    local code=$?
    if [[ $code -ne 0 ]]; then
        exit $code
    fi
}

function opy_labelme_main
{
    install_labelme_if_not_exist
    exit_on_error

    opy3 -m labelme "$@"
}

opy_labelme_main "$@"
