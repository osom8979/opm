#!/usr/bin/env bash

if [[ -z $(which opm-version 2> /dev/null) ]]; then
OPM_BIN_PATH=`cd "$(dirname "${BASH_SOURCE[0]}")"; echo "$PWD"`
PATH="$OPM_BIN_PATH:$PATH"
fi

function getmanager_linux_ubuntu_apt
{
    opm-println-error "Unsupported operation."
    return 1
}

function which_linux_ubuntu_apt
{
    which apt-get 2> /dev/null
}

function sync_linux_ubuntu_apt
{
    if [[ -z $(which_linux_ubuntu) ]]; then
        opm-println-error "Not found apt-get command."
        return 1
    fi

    sudo apt-get update
}

function exist_linux_ubuntu_apt
{
    if [[ -z $(which_linux_ubuntu) ]]; then
        opm-println-error "Not found apt-get command."
        return 1
    fi
    if [[ $# -eq 0 ]]; then
        opm-println-error "You must enter the package."
        return 1
    fi

    local packages=`dpkg -l | sed -n '/+++/,$p' | sed -n '2,$p' | awk '{print $2}'`
    for i in $@; do
        echo "$packages" | grep "^$i\$"
    done
}

function list_linux_ubuntu_apt
{
    if [[ -z $(which_linux_ubuntu) ]]; then
        opm-println-error "Not found apt-get command."
        return 1
    fi
    if [[ $# -eq 0 ]]; then
        opm-println-error "You must enter the package."
        return 1
    fi

    for i in $@; do
        dpkg -L $i | sed "s/^/$i /g"
    done
}

function install_linux_ubuntu_apt
{
    if [[ -z $(which_linux_ubuntu) ]]; then
        opm-println-error "Not found apt-get command."
        return 1
    fi
    if [[ $# -eq 0 ]]; then
        opm-println-error "You must enter the package."
        return 1
    fi

    sudo apt-get -y install "$@"
}

function remove_linux_ubuntu_apt
{
    if [[ -z $(which_linux_ubuntu) ]]; then
        opm-println-error "Not found apt-get command."
        return 1
    fi
    if [[ $# -eq 0 ]]; then
        opm-println-error "You must enter the package."
        return 1
    fi

    sudo apt-get -y purge "$@"
}

