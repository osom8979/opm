#!/usr/bin/env bash

if [[ -z $(which opm-version 2> /dev/null) ]]; then
PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" || exit; pwd):$PATH"
fi

function install_yt_dlp_if_not_exist
{
    opy3-pip show yt_dlp &> /dev/null
    local code=$?
    if [[ $code -eq 0 ]]; then
        return 0
    fi

    opy3-pip install -U yt-dlp
}

function exit_on_error
{
    local code=$?
    if [[ $code -ne 0 ]]; then
        exit $code
    fi
}

function opy_yt_dlp_main
{
    install_yt_dlp_if_not_exist
    exit_on_error

    opy3 -m yt_dlp "$@"
}

opy_yt_dlp_main "$@"
